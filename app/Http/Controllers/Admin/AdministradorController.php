<?php

namespace App\Http\Controllers\Admin;

use Illuminate\Http\Request;
use App\Http\Controllers\Controller;
use App\Administrador;

class AdministradorController extends Controller
{
    public function index()
    {
        $registros = Administrador::all();
        return view('admin.administrador.index', compact('registros'));
    }

    public function adicionar()
    {
      return view('admin.administrador.adicionar');
    }

    public function salvar(Request $req)
    {
        try{
            $dados = $req->all();
            if (isset($dados['status'])){
                $dados['status'] = 'sim';
            }else{
                $dados['status'] = 'nao';
            }

            if ($req->hasFile('imagem')){
                $imagem = $req->file('imagem');
                $num = rand(1111 , 9999);
                $dir = "img/adminitrador";
                $ex = $imagem->guessClientExtension();
                $nomeImagem = 'imagem_' . $num . '.' . $ex;
                $imagem->move($dir, $nomeImagem);
                $dados['imagem'] = $dir . '/' . $nomeImagem;
            }
            Administrador::create($dados);
            return redirect()->route('admin.administrador');

        }catch (\Exception $e){
            echo "Error:" . $e->getMessage() . '-' . $e->getFile();
        }

    }

    public function editar($id)
    {
        $registro = Administrador::find($id);
        return view('admin.administrador.editar', compact('registro'));
    }

    public function atualizar(Request $req, $id)
    {
        $dados = $req->all();

        if (isset($dados['status'])){
            $dados['status'] = 'sim';
        }else{
            $dados['status'] = 'nao';
        }
        $registros = Administrador::find($id)->update($dados);
        return redirect()->route('admin.administrador');
    }

    public function deletar($id)
    {
        Administrador::find($id)->delete();
        return redirect()->route('admin.administrador');
    }


}
